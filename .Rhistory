2+2
all_df <- data.frame(years = rep(0:40,10),
r = rep(rep(seq(.02,.11,length.out=5),each=41),2),
path = rep(c('HS','BS'),each=10*41/2))
npv_fcn <- function(year,r,path){
if(path=='HS'){
return((1-r)*year)
}
if(year<6){
return(-year)
}
return((2*year-15)*(1-r))
}
all_df <- all_df %>%
rowwise() %>%
mutate(npv = npv_fcn(years,r,path))
knitr::opts_chunk$set(message=FALSE)
library(tidyverse)
library(stats)
library(PropCIs)
library(binom)
library(ggnewscale)
library(car)
library(patchwork)
all_df <- data.frame(years = rep(0:40,10),
r = rep(rep(seq(.02,.11,length.out=5),each=41),2),
path = rep(c('HS','BS'),each=10*41/2))
npv_fcn <- function(year,r,path){
if(path=='HS'){
return((1-r)*year)
}
if(year<6){
return(-year)
}
return((2*year-15)*(1-r))
}
all_df <- all_df %>%
rowwise() %>%
mutate(npv = npv_fcn(years,r,path))
all_df
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)+
scale_fill_discrete(name = "New Legend Title")
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)+
scale_fill_discrete(name = "New Legend Title")
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)+
scale_color_discrete(name = "New Legend Title")
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)+
scale_color_discrete(name = "$r$")
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)+
scale_color_discrete(name = "r value")
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)+
scale_color_gradient(name = "r value")
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)+
scale_color_discrete(name = "r value")
cc <- scales::seq_gradient_pal("blue", "black", "Lab")(seq(0,1,length.out=5))
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)+
scale_color_manual(values=cc,name = "r value")
cc <- scales::seq_gradient_pal("blue", "red", "Lab")(seq(0,1,length.out=5))
ggplot( ,aes(x=years, y=npv, color=as.factor(r)))+
geom_line(data=filter(all_df,path=='HS'),linetype=1)+
geom_line(data=filter(all_df,path=='BS'),linetype=2)+
scale_color_manual(values=cc,name = "r value")
